#pragma once
#include <Windows.h>

extern HANDLE g_hDevice;
#define DEVICE_NAME L"\\\\.\\ThrottleStop"
#define THROTTLESTOP_IOCTL_READ_MEMORY      0x80006498
#define THROTTLESTOP_IOCTL_WRITE_MEMORY     0x8000649C
#define THROTTLESTOP_IOCTL_READ_IO_PORT     0x80006430
#define THROTTLESTOP_IOCTL_WRITE_IO_PORT    0x80006434


BOOL ReadPhysicalMemoryByte(ULONGLONG physicalAddress, PBYTE value);
BOOL ReadPhysicalMemoryWord(ULONGLONG physicalAddress, PWORD value);
BOOL ReadPhysicalMemoryDword(ULONGLONG physicalAddress, PDWORD value);
BOOL ReadPhysicalMemoryQword(ULONGLONG physicalAddress, PULONGLONG value);

BOOL WritePhysicalMemoryByte(ULONGLONG physicalAddress, BYTE value);
BOOL WritePhysicalMemoryWord(ULONGLONG physicalAddress, WORD value);
BOOL WritePhysicalMemoryDword(ULONGLONG physicalAddress, DWORD value);
BOOL WritePhysicalMemoryQword(ULONGLONG physicalAddress, ULONGLONG value);

BOOL ReadIoPortByte(USHORT port, PBYTE value);
BOOL ReadIoPortWord(USHORT port, PWORD value);
BOOL ReadIoPortDword(USHORT port, PDWORD value);
BOOL ReadIoPort(USHORT port, PDWORD value, SIZE_T size);

BOOL WriteIoPortByte(USHORT port, BYTE value);
BOOL WriteIoPortWord(USHORT port, WORD value);
BOOL WriteIoPortDword(USHORT port, DWORD value);
BOOL WriteIoPort(USHORT port, DWORD value, SIZE_T size);
