#pragma once
#include <Windows.h>

extern HANDLE g_hDevice;
#define DEVICE_NAME L"\\\\.\\ThrottleStop"
#define THROTTLESTOP_IOCTL_READ_MEMORY      0x80006498
#define THROTTLESTOP_IOCTL_WRITE_MEMORY     0x8000649C
#define THROTTLESTOP_IOCTL_READ_IO_PORT     0x80006430
#define THROTTLESTOP_IOCTL_WRITE_IO_PORT    0x80006434


BOOLEAN ReadPhysicalMemoryByte(ULONGLONG physicalAddress, PBYTE value);
BOOLEAN ReadPhysicalMemoryWord(ULONGLONG physicalAddress, PWORD value);
BOOLEAN ReadPhysicalMemoryDword(ULONGLONG physicalAddress, PDWORD value);
BOOLEAN ReadPhysicalMemoryQword(ULONGLONG physicalAddress, PULONGLONG value);

BOOLEAN WritePhysicalMemoryByte(ULONGLONG physicalAddress, BYTE value);
BOOLEAN WritePhysicalMemoryWord(ULONGLONG physicalAddress, WORD value);
BOOLEAN WritePhysicalMemoryDword(ULONGLONG physicalAddress, DWORD value);
BOOLEAN WritePhysicalMemoryQword(ULONGLONG physicalAddress, ULONGLONG value);

BOOLEAN ReadIoPortByte(USHORT port, PBYTE value);
BOOLEAN ReadIoPortWord(USHORT port, PWORD value);
BOOLEAN ReadIoPortDword(USHORT port, PDWORD value);
BOOLEAN ReadIoPort(USHORT port, PDWORD value, SIZE_T size);

BOOLEAN WriteIoPortByte(USHORT port, BYTE value);
BOOLEAN WriteIoPortWord(USHORT port, WORD value);
BOOLEAN WriteIoPortDword(USHORT port, DWORD value);
BOOLEAN WriteIoPort(USHORT port, DWORD value, SIZE_T size);